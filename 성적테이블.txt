-- sequence: 번호를 순차적으로 1씩 증가시켜주는 역할
create sequence seq_sungtb_no;

-- 테이블 생성
CREATE TABLE SUNGTB(
	NO NUMBER PRIMARY KEY,
	NAME VARCHAR2(100) NOT NULL,
	KOR NUMBER(3) NOT NULL,
	ENG NUMBER(3) NOT NULL,
	MAT NUMBER(3) NOT NULL
);

-- 샘플 데이터
INSERT INTO SUNGTB VALUES(SEQ_SUNGTB_NO.NEXTVAL, '홍길동', 77, 88, 99);
INSERT INTO SUNGTB VALUES(SEQ_SUNGTB_NO.NEXTVAL, '김길동', 67, 78, 89);
INSERT INTO SUNGTB VALUES(SEQ_SUNGTB_NO.NEXTVAL, '독고길동', 100, 99, 89);
INSERT INTO SUNGTB VALUES(SEQ_SUNGTB_NO.NEXTVAL, '하길동', 50, 78, 61);

-- COMMIT; 빼먹지 말기

-- 기존 성적테이블에서 총점과 평균까지 컬럼으로 조회할 수 있도록 하는 VIEW 생성
CREATE VIEW SUNGTB_VIEW AS 
	SELECT S.*, (KOR+ENG+MAT) TOT, ROUND((KOR+ENG+MAT)/3, 1) "AVG", RANK() OVER(ORDER BY (KOR+ENG+MAT) DESC) "RANK"
	FROM SUNGTB S
	ORDER BY NO;